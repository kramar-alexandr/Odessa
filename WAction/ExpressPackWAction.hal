globalupdating procedure CreateExpressListDsm()begin  record RcVc RepSpec;  Integer wn;    wn = CurWindow;  //if (GetWindowFileName(wn)=="ExpressPackVc") then begin  //end;  RECORDNEW(RepSpec);  OpenWindow("SpecifyExpressPackParamsClass",1,0,wn,"",RepSpec);    return;end;globalfunction Boolean ExpressPackLClassOnOpenWindow(integer wn)begin  Boolean res;  record USerVc Userr;  Userr.Code = currentuser;  if (ReadFirstMain(Userr,1,true) and NonBlank(Userr.Location)) then begin    SetWindowSubset(wn,Userr.Location);  end;    ExpressPackLClassOnOpenWindow = false;  return;end;function Boolean ExpressPackDClassArtCodeEFAfter(Integer wn,Integer rownr,Integer changedf)begin    record ExpressPackVc ExpressPackr;  record INVc INr;  row ExpressPackVc ExpressPackrw;   if (changedf!=0) then begin    GetWindowRecord(wn,ExpressPackr);    if (rownr>-1) then begin      MatRowGet(ExpressPackr,rownr,ExpressPackrw);      INr.Code = ExpressPackrw.ArtCode;      if (ReadFirstMain(INr,1,true)) then begin        ExpressPackrw.Spec = INr.Name;        MatRowPut(ExpressPackr,rownr,ExpressPackrw);      end;    end;    PutWindowRecord(wn,ExpressPackr);  end;    ExpressPackDClassArtCodeEFAfter = true;  return;end;globalfunction Boolean ExpressPackDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)BEGIN  Boolean res;  switch (fieldname) begin    case "ArtCode": res = ExpressPackDClassArtCodeEFAfter(wn,rownr,changed);  end;  ExpressPackDClassAfterEditField = res;  RETURN;  END;globalfunction Boolean ExpressPackDClassOrdStatus00ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus00ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus01ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus01ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus02ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus02ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus03ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus03ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus04ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus04ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus05ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus05ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus06ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus06ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus07ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus07ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus08ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus08ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus09ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus09ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus10ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus10ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus11ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus11ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus12ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus12ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus13ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus13ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus14ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus14ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus15ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus15ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus16ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus16ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus17ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus17ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus18ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus18ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus19ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus19ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus20ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus20ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus21ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus21ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus22ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus22ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus23ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus23ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus24ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus24ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus25ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus25ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus26ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus26ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus27ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus27ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus28ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus28ButtonAction = res;  return;end;globalfunction Boolean ExpressPackDClassOrdStatus29ButtonAction(Integer wn,Integer value)begin  Boolean res;  record ExpressPackVc ExpressPackr;  Integer normalmode,updatemode;    res = false;  normalmode = 0;//Rs_normal  updatemode = 2;//Rs_update    /*if (WindowState(wn)==normalmode) then begin    GetWindowRecord(wn,ExpressPackr);  end;    if (WindowState(wn)==updatemode) then begin    GetPrevWindowRecord(wn,ExpressPackr);  end;*/    ExpressPackDClassOrdStatus29ButtonAction = res;  return;end;