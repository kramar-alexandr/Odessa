external function LongInt TimeDiffInSeconds(Time,Time);global procedure ExpSalesStatEn(record RcVc RepSpec)beginrecord IVVc IVr;row IVVc IVrw;string 50 location;boolean TrHs,testf;integer i,mtrw,lines;	location = RepSpec.f1;		if(nonblank(location))then begin				IVr.Location = location;		TrHs = true;		While(loopkey("Location",IVr,1,true)) begin	  	testf = true;	  	if(IVr.Location!=location)then begin testf = false; TrHs = false; end;	  	if(IVr.OKFlag==0)then begin testf = false; end;	  	if(IVr.Invalid==1)then begin testf = false; end;	  	lines = 0;	  		  	if(testf)then begin	  		mtrw = matrowcnt(IVr);	  		For(i=0;i<mtrw;i=i+1) begin	  			matrowget(IVr,i,IVrw);	  			if(IVrw.stp==kInvoiceRowTypeNormal)then begin	  				if(IVrw.Sum!=0)then begin	  					lines = lines + 1;	  				end;	  			end;				end; 	 				ExportPadString("\"" & location & "\",",len(location)+3,"",false);				ExportPadString("\"" & DateToString(IVr.InvDate,"YYYY/MM/DD") & "\",",len(DateToString(IVr.InvDate,"YYYY/MM/DD"))+3,"",false);				ExportPadString("\"" & TimeDiffInSeconds(stringtotime("0:0:0"),addhours(IVr.TransTime,1)) & "\",",len(TimeDiffInSeconds(stringtotime("0:0:0"),addhours(IVr.TransTime,1)))+3,"",false);				ExportPadString("\"" & GetDateID(IVr.InvDate) & "\",",len(GetDateID(IVr.InvDate))+3,"",false);				ExportPadString("\"" & gethour(IVr.TransTime)+1 & "\",",len(gethour(IVr.TransTime)+1)+3,"",false);				ExportPadString("\"" & lines & "\",",len(lines)+3,"",false);				ExportPadString("\"" & valtostring(IVr.Sum4,M4UVal,"",".",0) & "\"",len(valtostring(IVr.Sum4,M4UVal,"",".",0))+2,"",false);				ExportPadString(chr(13) & chr(10),2,"",false);	  	end;		end; 					end;return;end;