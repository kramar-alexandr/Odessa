SetLangMode(LangRussian,"RUS",0);globalprocedure CheckItemsOnStockORRn(record RcVc RepSpec)BEGIN  record ORVc ORr;  row ORVc ORrw;  record ItemStatusVc ISr;  boolean TrHs,testf;	Integer pos,rwcnt,i,inst,withoutrsrv;	LongInt orsernr;	string 10 leadingloc,loc1,loc2,loc3,loc4,loc5,dblval;    StartReportJob("Доступность товаров на складах");    orsernr = RepSpec.long1;    Header(3,USetStr(8611) & ": " & orsernr,0);  EndHeader;    ORr.SerNr = orsernr;  if (ReadFirstMain(ORr,1,true)) then begin    loc1 = "RYBRAY";    loc2 = "3-RAY";    loc3 = "4-NIZ";    loc4 = "1-KOC";    loc5 = "6-KV";        if (ORr.Location==loc1) then begin      leadingloc = loc1; loc1 = "";    end else begin      if (ORr.Location==loc2) then begin        leadingloc = loc2; loc2 = "";      end else begin        if (ORr.Location==loc3) then begin          leadingloc = loc3; loc3 = "";        end else begin          if (ORr.Location==loc4) then begin            leadingloc = loc4; loc4 = "";          end else begin            if (ORr.Location==loc5) then begin              leadingloc = loc5; loc5 = "";            end;          end;        end;      end;    end;        pos = 0;    StartFormat(15);      OutString(pos,0,"Примечание: ХХХ(ХХХ) - кол-во товара на складе(кол-во товара на складе с вычетом резерва)",false);    EndFormat;    StartFormat(15);      OutString(pos,0,"",false);    EndFormat;    StartFormat(15);      OutString(pos,0,USetStr(26380),false);      OutString(pos+=40,0,USetStr(26306),false);      OutString(pos+=100,0,USetStr(5050),true);      OutString(pos+=40,0,leadingloc,true);      if (NonBlank(loc1)) then begin        OutString(pos+=40,0,loc1,true);      end;      if (NonBlank(loc2)) then begin        OutString(pos+=40,0,loc2,true);      end;      if (NonBlank(loc3)) then begin        OutString(pos+=40,0,loc3,true);      end;      if (NonBlank(loc4)) then begin        OutString(pos+=40,0,loc4,true);      end;      if (NonBlank(loc5)) then begin        OutString(pos+=40,0,loc5,true);      end;    EndFormat;        rwcnt = MatRowCnt(ORr);    for (i=0;i<rwcnt;i=i+1) begin      matrowget(ORr,i,ORrw);      if (NonBlank(ORrw.ArtCode)) then begin        pos = 0;        StartFormat(15);          OutString(pos,0,ORrw.ArtCode,false);          OutString(pos+=40,0,ORrw.Spec,false);          inst = ORrw.Quant;          OutString(pos+=100,0,inst,true);                    ISr.Code = ORrw.ArtCode;          ISr.Location = leadingloc;          ReadFirstMain(ISr,2,true);          inst = ISr.Instock;          withoutrsrv = ISr.Instock - ISr.RsrvQty;          if (ORrw.Quant>withoutrsrv) then begin            dblval = "DblNotExist";          end else begin            dblval = 0;          end;          OutString(pos+=40,dblval,inst & "(" & withoutrsrv & ")",true);                    if (NonBlank(loc2)) then begin            ISr.Code = ORrw.ArtCode;            ISr.Location = loc2;            ReadFirstMain(ISr,2,true);            inst = ISr.Instock;            withoutrsrv = ISr.Instock - ISr.RsrvQty;            if (ORrw.Quant>withoutrsrv) then begin              dblval = "DblNotExist";            end else begin              dblval = 0;            end;            OutString(pos+=40,dblval,inst & "(" & withoutrsrv & ")",true);          end;                    if (NonBlank(loc3)) then begin            ISr.Code = ORrw.ArtCode;            ISr.Location = loc3;            ReadFirstMain(ISr,2,true);            inst = ISr.Instock;            withoutrsrv = ISr.Instock - ISr.RsrvQty;            if (ORrw.Quant>withoutrsrv) then begin              dblval = "DblNotExist";            end else begin              dblval = 0;            end;            OutString(pos+=40,dblval,inst & "(" & withoutrsrv & ")",true);          end;                    if (NonBlank(loc4)) then begin            ISr.Code = ORrw.ArtCode;            ISr.Location = loc4;            ReadFirstMain(ISr,2,true);            inst = ISr.Instock;            withoutrsrv = ISr.Instock - ISr.RsrvQty;            if (ORrw.Quant>withoutrsrv) then begin              dblval = "DblNotExist";            end else begin              dblval = 0;            end;            OutString(pos+=40,dblval,inst & "(" & withoutrsrv & ")",true);          end;                    if (NonBlank(loc5)) then begin            ISr.Code = ORrw.ArtCode;            ISr.Location = loc5;            ReadFirstMain(ISr,2,true);            inst = ISr.Instock;            withoutrsrv = ISr.Instock - ISr.RsrvQty;            if (ORrw.Quant>withoutrsrv) then begin              dblval = "DblNotExist";            end else begin              dblval = 0;            end;            OutString(pos+=40,dblval,inst & "(" & withoutrsrv & ")",true);          end;       EndFormat;       end;    end;  end else begin    StartFormat(15);      OutString(0,0,"Order was not found",false);    EndFormat;  end;    endjob;  LCheckItemsOnStockORRn:;     RETURN;END;